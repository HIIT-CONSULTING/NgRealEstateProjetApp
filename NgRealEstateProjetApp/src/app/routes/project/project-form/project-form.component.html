<mat-card>
  <form [formGroup]="form">
    <mat-horizontal-stepper linear #stepper>
      <mat-step>
        <ng-template matStepLabel>
          {{ "Property.transaction" | translate }}
        </ng-template>
        <mat-card>
          <mat-card-content>
            <div
              fxLayout="column"
              fxLayoutAlign="center center"
              fxLayoutGap="20px"
              style="margin-top: 8%; margin-bottom: 5%"
            >
              <button
                class="full-widt"
                mat-stroked-button
                matStepperNext
                (click)="OnClickTransaction('Achat')"
              >
                ACHAT
              </button>
              <button
                class="full-widt"
                mat-stroked-button
                matStepperNext
                (click)="OnClickTransaction('Vente')"
              >
                VENTE
              </button>
            </div>
          </mat-card-content>
        </mat-card>
      </mat-step>

      <mat-step>
        <ng-template matStepLabel>
          {{ "Property.domaine" | translate }}
        </ng-template>
        <mat-card>
          <mat-card-content>
            <div
              fxLayout="column"
              fxLayoutAlign="center center"
              fxLayoutGap="20px"
              style="margin-top: 8%; margin-bottom: 5%"
            >
              <button
                class="full-widt"
                mat-stroked-button
                matStepperNext
                (click)="OnClickDomain('Neuf')"
              >
                NEUF
              </button>

              <button
                class="full-widt"
                mat-stroked-button
                matStepperNext
                (click)="OnClickDomain('Traditionnel')"
              >
                TRADITIONNEL
              </button>
            </div>
            <button
              mat-button
              matStepperPrevious
              mat-stroked-button
              class="full"
            >
              <i class="fas fa-arrow-left"> </i>&nbsp;&nbsp;&nbsp;{{
                "Property.previous" | translate
              }}
            </button>
          </mat-card-content>
        </mat-card>
      </mat-step>

      <mat-step>
        <ng-template matStepLabel>
          {{ "Property.destination" | translate }}
        </ng-template>
        <mat-card>
          <mat-card-content>
            <div
              fxLayout="column"
              fxLayoutAlign="center center"
              fxLayoutGap="20px"
              style="margin-top: 8%; margin-bottom: 5%"
            >
              <button
                class="full-widt"
                matStepperNext
                mat-stroked-button
                (click)="OnClickDestination('Entreprise et Commerce')"
              >
                ENTREPRISE & COMMERCE
              </button>

              <button
                class="full-widt"
                mat-stroked-button
                matStepperNext
                (click)="OnClickDestination('Habitation')"
              >
                HABITATION
              </button>
            </div>
            <button
              mat-button
              matStepperPrevious
              mat-stroked-button
              class="full"
            >
              <i class="fas fa-arrow-left"> </i>&nbsp;&nbsp;&nbsp;{{
                "Property.previous" | translate
              }}
            </button>
          </mat-card-content>
        </mat-card>
      </mat-step>

      <mat-step>
        <ng-template matStepLabel>
          {{ "Property.property_type" | translate }}
        </ng-template>
        <mat-card *ngIf="!choose">
          <mat-card-content>
            <div
              fxLayout="column"
              fxLayoutAlign="center center"
              fxLayoutGap="20px"
              style="margin-top: 8%; margin-bottom: 5%"
            >
              <button
                class="full-widt"
                mat-stroked-button
                matStepperNext
                (click)="OnClickProperty(3)"
              >
                APPARTEMENT
              </button>

              <button
                class="full-widt"
                mat-stroked-button
                matStepperNext
                (click)="OnClickProperty(1)"
              >
                IMMEUBLE
              </button>

              <button
                class="full-widt"
                mat-stroked-button
                matStepperNext
                (click)="OnClickProperty(5)"
              >
                MAISON
              </button>

              <button
                class="full-widt"
                mat-stroked-button
                matStepperNext
                (click)="OnClickProperty(4)"
              >
                TERRAIN
              </button>
            </div>
            <button
              mat-button
              matStepperPrevious
              mat-stroked-button
              class="full"
            >
              <i class="fas fa-arrow-left"> </i>&nbsp;&nbsp;&nbsp;{{
                "Property.previous" | translate
              }}
            </button>
          </mat-card-content>
        </mat-card>

        <mat-card *ngIf="choose">
          <mat-card-content>
            <div
              fxLayout="column"
              fxLayoutAlign="center center"
              fxLayoutGap="20px"
              style="margin-top: 8%; margin-bottom: 5%"
            >
              <button
                class="full-widt"
                mat-stroked-button
                matStepperNext
                (click)="OnClickProperty(6)"
              >
                MURS
              </button>

              <button
                class="full-widt"
                mat-stroked-button
                matStepperNext
                (click)="OnClickProperty(7)"
              >
                FOND DE COMMERCE
              </button>
            </div>
            <button
              mat-button
              matStepperPrevious
              mat-stroked-button
              class="full"
            >
              <i class="fas fa-arrow-left"> </i>&nbsp;&nbsp;&nbsp;{{
                "Property.previous" | translate
              }}
            </button>
          </mat-card-content>
        </mat-card>
      </mat-step>

      <mat-step>
        <form [formGroup]="properties">
          <ng-template matStepLabel>
            {{ "Property.informations" | translate }}
          </ng-template>
          <mat-card>
            <div style="margin-top: 8%; margin-bottom: 5%">
              <mat-accordion
                fxLayout="column"
                fxLayoutAlign="center center"
                fxLayoutGap="20px"
              >
                <mat-expansion-panel #panel1 style="width: 100%">
                  <mat-expansion-panel-header
                    class="disable_ripple"
                    [collapsedHeight]="'70px'"
                    [expandedHeight]="'70px'"
                  >
                    <mat-panel-title>
                      <div class="title-cardd">
                        {{ "Property.form.propery_title" | translate }}
                      </div>
                    </mat-panel-title>
                  </mat-expansion-panel-header>
                  <div formGroupName="address">
                    <div
                      fxLayout="column"
                      fxLayoutAlign="space-between center "
                      style="margin-top: 30px"
                    >
                      <mat-form-field appearance="outline" class="full-width">
                        <mat-label>
                          {{ "form_standard.country" | translate }}
                        </mat-label>
                        <mat-select formControlName="country">
                          <mat-option
                            *ngFor="let country of country$ | async"
                            [value]="country.id"
                            (click)="OnCountry(country.id)"
                            >{{ country.name }}
                          </mat-option>
                        </mat-select>
                        <mat-error
                          *ngIf="properties.get('address.country').invalid"
                        >
                          {{ "Property.form.country.error" | translate }}
                        </mat-error>
                      </mat-form-field>
                    </div>

                    <div
                      fxLayout="column"
                      fxLayoutAlign="space-between center "
                    >
                      <mat-form-field appearance="outline" class="full-width">
                        <mat-label>
                          {{ "form_standard.city" | translate }}
                        </mat-label>
                        <mat-select formControlName="city">
                          <mat-option
                            *ngFor="let city of city$ | async"
                            [value]="city.id"
                            >{{ city.name }}
                          </mat-option>
                        </mat-select>
                        <mat-error
                          *ngIf="properties.get('address.city').invalid"
                        >
                          {{ "Property.form.city.error" | translate }}
                        </mat-error>
                      </mat-form-field>
                    </div>

                    <div
                      fxLayout="column"
                      fxLayoutAlign="space-between center "
                    >
                      <mat-form-field class="full-width" appearance="outline">
                        <mat-label>
                          {{ "form_standard.address" | translate }}
                        </mat-label>
                        <i matSuffix class="fas fa-lg fa-address-card"></i>
                        <input
                          matInput
                          name="address"
                          formControlName="description"
                        />
                        <mat-error
                          *ngIf="properties.get('address.description').invalid"
                        >
                          {{ "Property.form.description.error" | translate }}
                        </mat-error>
                      </mat-form-field>
                    </div>
                  </div></mat-expansion-panel
                >
                <mat-expansion-panel #panel2 style="width: 100%">
                  <mat-expansion-panel-header
                    class="disable_ripple"
                    [collapsedHeight]="'70px'"
                    [expandedHeight]="'70px'"
                  >
                    <div class="title-cardd">
                      {{ "Property.form.area" | translate }}
                    </div>
                  </mat-expansion-panel-header>
                  <div
                    fxLayout="column"
                    fxLayoutAlign="space-between center "
                    style="margin-top: 30px"
                  >
                    <mat-form-field class="full-width" appearance="outline">
                      <mat-label>
                        {{ "Property.form.area" | translate }}</mat-label
                      >
                      <i matSuffix class="fas fa-lg fa-chart-area"></i>
                      <input
                        type="number"
                        min="0"
                        matInput
                        name="area"
                        formControlName="area"
                      />
                      <mat-error *ngIf="properties.get('area').invalid">
                        {{ "Property.form.area.error" | translate }}
                      </mat-error>
                    </mat-form-field>
                  </div>

                  <div
                    fxLayout="column"
                    fxLayoutAlign="space-between center "
                    style="margin-top: 30px"
                  >
                    <mat-form-field class="full-width" appearance="outline">
                      <mat-label> {{ "Property.form.areaEsteme" | translate }} </mat-label>
                      <i matSuffix class="fas fa-lg fa-chart-area"></i>
                      <input
                        type="number"
                        min="0"
                        matInput
                        name="estimatedSurface"
                        formControlName="estimatedSurface"
                      />
                      <mat-error
                        *ngIf="properties.get('estimatedSurface').invalid"
                      >
                        {{ "Property.form.area.error" | translate }}
                      </mat-error>
                    </mat-form-field>
                  </div>
                </mat-expansion-panel>
                <mat-expansion-panel #panel3 style="width: 100%">
                  <mat-expansion-panel-header
                    class="disable_ripple"
                    [collapsedHeight]="'70px'"
                    [expandedHeight]="'70px'"
                  >
                    <div class="title-cardd">
                      {{ "Property.form.budget" | translate }}
                    </div>
                  </mat-expansion-panel-header>
                  <div
                    fxLayout="column"
                    fxLayoutAlign="space-between center "
                    style="margin-top: 30px"
                  >
                    <mat-form-field class="full-width" appearance="outline">
                      <mat-label>
                        {{ "Property.form.pricemin" | translate }}
                      </mat-label>
                      <mat-icon
                        matSuffix
                        aria-hidden="false"
                        aria-label="Example home icon"
                        >attach_money</mat-icon
                      >
                      <input
                        type="number"
                        min="0"
                        matInput
                        name="minimalPrice"
                        formControlName="minimalPrice"
                      />
                      <mat-error *ngIf="properties.get('minimalPrice').invalid">
                        {{ "Property.form..minimalPrice.error" | translate }}
                      </mat-error>
                    </mat-form-field>
                  </div>
                  <div fxLayout="column" fxLayoutAlign="space-between center ">
                    <mat-form-field class="full-width" appearance="outline">
                      <mat-label>
                        {{ "Property.form.pricemax" | translate }}
                      </mat-label>
                      <mat-icon
                        matSuffix
                        aria-hidden="false"
                        aria-label="Ex"
                        >attach_money</mat-icon
                      >
                      <input
                        type="number"
                        min="0"
                        matInput
                        name="maximumPrice"
                        formControlName="maximumPrice"
                      />
                      <mat-error *ngIf="properties.get('maximumPrice').invalid">
                        {{ "Property.form.maximumPrice.error" | translate }}
                      </mat-error>
                    </mat-form-field>
                  </div>
                </mat-expansion-panel>

                <mat-expansion-panel #panel4 style="width: 100%"  *ngIf="properties.get('propertyType').value !=4">
                  <mat-expansion-panel-header
                    class="disable_ripple"
                    [collapsedHeight]="'70px'"
                    [expandedHeight]="'70px'"
                  >
                    <div class="title-cardd">Construction</div>
                  </mat-expansion-panel-header>

                  <div
                    fxLayout="column"
                    fxLayoutAlign="space-between center "
                    style="margin-top: 30px"
                  >
                  <mat-form-field appearance="outline" class="full-width">
                    <mat-label>{{"Property.form.state" | translate }}</mat-label>
                    <mat-select formControlName="state" >
                      <mat-option *ngFor="let state of stateList" [value]="state">{{state}}</mat-option>
                    </mat-select>
                  </mat-form-field>
                  </div>
                  <div
                    fxLayout="column"
                    fxLayoutAlign="space-between center "
                    style="margin-top: 30px"
                  >
                  <mat-form-field appearance="outline" class="full-width">
                    <mat-label> {{"Property.form.orientation" | translate }}</mat-label>
                    <mat-select formControlName="orientation" >
                      <mat-option *ngFor="let orientation of orientationList" [value]="orientation">{{orientation}}</mat-option>
                    </mat-select>
                  </mat-form-field>
                  
















                  </div>
                  <div
                    fxLayout="column"
                    fxLayoutAlign="space-between center "
                    style="margin-top: 30px"
                  >
                    <mat-form-field class="full-width" appearance="outline">
                      <mat-label>{{"Property.form.constructionYear" | translate }}</mat-label>
                      <input
                        matInput
                        [matDatepicker]="picker"
                        formControlName="constructionYear"
                      />
                      <mat-datepicker-toggle
                        matSuffix
                        [for]="picker"
                      ></mat-datepicker-toggle>
                      <mat-datepicker #picker></mat-datepicker>
                    </mat-form-field>
                  </div>
                  <div
                    fxLayout="column"
                    fxLayoutAlign="space-between center "
                    style="margin-top: 30px"
                  >
                    <mat-form-field class="full-width" appearance="outline">
                      <mat-label> {{"Property.form.floorsNumber" | translate }} </mat-label>

                      <input
                        matInput
                        type="number"
                        min="0"
                        formControlName="floorsNumber"
                      />
                    </mat-form-field>
                  </div>
                  
                  <div
                    fxLayout="column"
                    fxLayoutAlign="space-between center "
                    style="margin-top: 30px"
                  >
                    <div fxLayout="row" fxLayoutAlign="space-between center ">
                      <mat-checkbox
                        
                        formControlName="hasElevator"
                        >{{"Property.form.hasElevator" | translate }}</mat-checkbox
                      >
                      <mat-checkbox
                        
                        formControlName="hasTerace"
                        >{{"Property.form.hasTerace" | translate }}</mat-checkbox
                      >
                      <mat-checkbox
                        
                        formControlName="hasBalcony"
                        > {{"Property.form.hasBalcony" | translate }}</mat-checkbox
                      >
                      <mat-checkbox
                        
                        formControlName="hasGuardian"
                        >{{"Property.form.hasGuardian" | translate }}</mat-checkbox
                      >
                      <mat-checkbox
                        
                        formControlName="hasIntercom"
                        >{{"Property.form.hasIntercom" | translate }}</mat-checkbox
                      >
                    </div>
                  </div>
                  <div
                  fxLayout="column"
                  fxLayoutAlign=" center center "
                  style="margin-top: 30px"
                >
                  <div fxLayout="row" fxLayoutAlign="space-between center ">
                                      <mat-checkbox 
                                        class="example-margin"
                                        formControlName="hasGarage"
                                        > {{"Property.form.hasGarage" | translate }}</mat-checkbox
                                      >
                                      <mat-checkbox 
                                        class="example-margin"
                                        formControlName="hasCellar"
                                        > {{"Property.form.hasCellar" | translate }}</mat-checkbox
                                      >
                                      <mat-checkbox
                                      
                                        class="example-margin"
                                        formControlName="hasParkCar"
                                        (click)="
                                          handleChange('hasParkCarOutside');
                                          handleChange('hasBasement')
                                        "
                                        >{{"Property.form.hasParkCar" | translate }}</mat-checkbox
                                      >
                                      <mat-checkbox 
                                        class="example-margin"
                                        formControlName="hasParkCarOutside"
                                        [disabled]="!properties.get('hasParkCar').value"
                                        >{{"Property.form.hasParkCarOutside" | translate }}</mat-checkbox
                                      >
                                      <mat-checkbox 
                                        class="example-margin"
                                        formControlName="hasBasement"
                                        [disabled]="!properties.get('hasParkCar').value"
                                        >{{"Property.form.hasBasement" | translate }}</mat-checkbox
                                      >
                                    </div>
                                  </div>
                </mat-expansion-panel>
                
                <mat-expansion-panel #panel4 style="width: 100%">
                  <mat-expansion-panel-header
                    class="disable_ripple"
                    [collapsedHeight]="'70px'"
                    [expandedHeight]="'70px'"
                  >
                    <div class="title-cardd">Plus d'informations </div>
                  </mat-expansion-panel-header>
                  <div
                    fxLayout="column"
                    fxLayoutAlign="space-between center "
                    style="margin-top: 2%"

                    *ngIf="properties.get('propertyType').value !=4"
                  >
                    <mat-form-field class="full-width" appearance="outline">
                      <mat-label>
                        {{ "Property.form.nbpieces" | translate }}</mat-label
                      >
                      <input
                        matInput
                        name="room"
                        type="number"
                        min="0"
                        formControlName="room"
                      />
                    </mat-form-field>
                  </div>

                  <div fxLayoutAlign="center" style="margin-top: 2%">
                    <div fxLayoutAlign="space-between center" class="full-width">
                
                      <div appearance="outline" fxFlex fxLayoutAlign="space-between center" >
                        <mat-radio-group formControlName="isAvailable">
                            <mat-radio-button
                              class="example-margin"
                              [value]="true"
                              (click)="handleChange('dateAvailability')"
                              > {{"Property.form.isAvailable" | translate }}</mat-radio-button
                            >
                            <mat-radio-button class="example-margin" [value]="false"
                              >{{"Property.form.notAvailable" | translate }}</mat-radio-button
                            >
                          </mat-radio-group>
                      </div>
                
                       <mat-form-field appearance="outline" fxFlex="40">
                        <mat-label>{{"Property.form.dateAvailability" | translate }}</mat-label>
                        <input
                          matInput
                          [matDatepicker]="picker1"
                          [disabled]="properties.get('isAvailable').value"
                          formControlName="dateAvailability"
                        />
                        <mat-datepicker-toggle
                          matSuffix
                          [for]="picker1"
                          [disabled]="properties.get('isAvailable').value"
                        ></mat-datepicker-toggle>
                        <mat-datepicker #picker1></mat-datepicker>
                        
                       </mat-form-field>
                
                    </div>
                 </div>
                
                 <div fxLayoutAlign="center" style="margin-top: 2%"  *ngIf="properties.get('propertyType').value !=4">
                  <div fxLayoutAlign="space-between center" class="full-width">
              
                    <div appearance="outline" fxFlex fxLayoutAlign="space-between center" >
                      <mat-checkbox
                      class="example-margin"
                      (click)="handleChange('keysNumber')"
                      formControlName="hasKey"
                      > {{"Property.form.hasKey" | translate }}</mat-checkbox
                    >
                    </div>
              
                     <mat-form-field appearance="outline" fxFlex="40">
                      <mat-label>{{"Property.form.keysNumber" | translate }} </mat-label>
                      <input
                        matInput
                        type="number"
                        min="0"
                        formControlName="keysNumber"
                      />
                     </mat-form-field>
              
                  </div>
               </div>
                </mat-expansion-panel>
              </mat-accordion>
            </div>
            <div fxLayout="row" fxLayoutAlign="space-around end">
              <button
                mat-button
                matStepperPrevious
                mat-stroked-button
                class="full"
                style="margin-left: -25%"
              >
                <i class="fas fa-arrow-left"> </i>&nbsp;&nbsp;&nbsp;{{
                  "Property.previous" | translate
                }}
              </button>
              <button
                class="full"
                mat-button
                matStepperNext
                mat-stroked-button
                [disabled]="properties.invalid"
                style="margin-right: -25%"
              >
                {{ "Property.next" | translate }} &nbsp;&nbsp;&nbsp;<i
                  class="fas fa-arrow-right"
                ></i>
              </button>
            </div>
          </mat-card>
        </form>
      </mat-step>

      <mat-step>
        <ng-template matStepLabel>
          {{ "Property.contact" | translate }}
        </ng-template>
        <mat-card>
          <div style="margin-top: 8%">
            <mat-card-content>
              <div
                fxLayout="row"
                fxLayoutAlign="space-between center"
                style="margin-top: 7%"
              >
                <ng-select
                  [items]="(contacts$ | async)?.items"
                  bindLabel="firstname"
                  bindValue="id"
                  autofocus
                  class="full-width"
                  appearance="outline"
                  [(ngModel)]="selectedPersonId"
                  placeholder="{{ 'Property.select_contact' | translate }}"
                  formControlName="contact"
                  (click)="OnClick()"
                >
                </ng-select>
               
                <span>{{"Property.form.or" | translate }} </span>
                <a>
                  <button
                    mat-button
                    mat-stroked-button
                    style="margin-right: -30%"
                    (click)="openDialog()"
                  >
                    <i class="fa fa-2x fa-user-plus"></i> &nbsp;&nbsp;&nbsp;
                    {{ "Contact.title" | translate }}
                  </button>
                </a>
              </div>
              <div
                style="margin-top: 5%; font-size: medium; font-family: serif"
              >
                {{ "Property.contactresult" | translate }} :
              </div>
              <div
                *ngIf="!show"
                style="
                  font-size: medium;
                  font-family: serif;
                  margin-top: 1%;
                  margin-left: 3%;
                "
              >
                Aucune donnée renseignée
              </div>

              <mat-card *ngIf="show" style="margin-top: 2%; width: 70%">
                <div fxLayout="row" fxLayoutAlign="space-evenly ">
                  <img
                    mat-card-image
                    fxFlex="15"
                    fxLayoutAlign="start none"
                    src="./assets/images/profile.png"
                  />

                  <section fxFlex="60">
                    <div class="name1" style="font-size: large">
                      {{ contact?.firstname }}&nbsp;{{
                        contact?.lastname | uppercase
                      }}
                    </div>
                    <div class="role">Acheteur</div>

                    <div
                      style="
                        margin-top: 2%;
                        margin-bottom: 0.5%;
                        font-family: initial;
                        color: darkblue;
                      "
                    >
                      ADRESSE :
                    </div>
                    <div style="font-family: initial; font-size: large">
                      {{ contact?.address?.description }},&nbsp;{{contact?.address?.city.name}},&nbsp;{{contact?.address?.country.name }}
                    </div>
                  </section>
                </div>
              </mat-card>
            </mat-card-content>
            <mat-card-actions>
              <div
                fxLayout="row"
                fxLayoutAlign="space-around end"
                style="margin-top: 6%"
              >
                <button
                  mat-button
                  matStepperPrevious
                  mat-stroked-button
                  class="full"
                  style="margin-left: -22%"
                >
                  <i class="fas fa-arrow-left"> </i>&nbsp;&nbsp;&nbsp;{{
                    "title-previous" | translate
                  }}
                </button>
                <button
                  class="full"
                  (click)="save()"
                  mat-button
                  mat-stroked-button
                  style="margin-right: -22%"
                  [disabled]="form.invalid"
                >
                  ENREGISTRER &nbsp;&nbsp;&nbsp;<i class="fas fa-save"></i>
                </button>
              </div>
            </mat-card-actions>
          </div>
        </mat-card>
      </mat-step>
    </mat-horizontal-stepper>
  </form>
</mat-card>
<!--<div fxLayoutAlign="center">
    <div fxLayoutAlign="space-between center" class="full-width">

      <mat-form-field appearance="outline" fxFlex="45">
         
      </mat-form-field>

       <mat-form-field appearance="outline" fxFlex="45">
          
       </mat-form-field>

    </div>
 </div>
 -->